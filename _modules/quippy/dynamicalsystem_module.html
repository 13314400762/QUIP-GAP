

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>quippy.dynamicalsystem_module &mdash; quippy e17b032+ documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> quippy
          

          
            
            <img src="../../_static/hybrid.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                e17b032+
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation of QUIP and quippy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quippy.html">Quippy library reference</a></li>
</ul>

            
          
    <p></p>
    <ul>
        <li><a href="../../genindex.html">Index</a></li>
        <li><a href="../../py-modindex.html">Module Index</a></li>
        <li><a href="../../search.html">Search Page</a></li>
        <li><a href="../index.html">Module Source Code</a></li>
    </ul>
  
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">quippy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>quippy.dynamicalsystem_module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for quippy.dynamicalsystem_module</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module dynamicalsystem_module</span>


<span class="sd">Defined at DynamicalSystem.fpp lines 154-2580</span>

<span class="sd">A DynamicalSystem object contains an Atoms object, which holds infomation about</span>
<span class="sd">velocities and accelerations of each atom, scalar quantities such as</span>
<span class="sd">thermostat settings, and logical masks so that thermostatting can be applied</span>
<span class="sd">to selected atoms etc.</span>

<span class="sd">In Fortran code, initialise a DynamicalSystem object like this:</span>
<span class="sd">&gt; 	call initialise(MyDS, MyAtoms)</span>
<span class="sd">which(shallowly) copies MyAtoms into the internal atoms structure(and so</span>
<span class="sd">MyAtoms is not required by MyDS after this call and can be finalised). In Python,</span>
<span class="sd">a DynamicalSystem can be initialised from an Atoms instance:</span>
<span class="sd">&gt;     MyDS = DynamicalSystem(MyAtoms)</span>


<span class="sd">A DynamicalSystem is constructed from an Atoms object</span>
<span class="sd">&#39;atoms&#39;. The initial velocities and accelerations can optionally be</span>
<span class="sd">specificed as &#39;(3,atoms.n)&#39; arrays. The &#39;constraints&#39; and</span>
<span class="sd">&#39;rigidbodies&#39; arguments can be used to specify the number of</span>
<span class="sd">constraints and rigid bodies respectively(the default is zero in</span>
<span class="sd">both cases).</span>

<span class="sd">DynamicalSystem has an integrator,</span>
<span class="sd">&gt; 	call advance_verlet(MyDS,dt,forces)</span>
<span class="sd">which takes a set of forces and integrates the equations of motion forward</span>
<span class="sd">for a time &#39;dt&#39;.</span>

<span class="sd">All dynamical variables are stored inside the Atoms&#39; :attr:`~quippy.atoms.Atoms.properties` Dictionary.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">quippy._quippy</span>
<span class="kn">import</span> <span class="nn">f90wrap.runtime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">quippy.atoms_types_module</span> <span class="kn">import</span> <span class="n">Atoms</span>

<span class="n">_arrays</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">_objs</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nd">@f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">register_class</span><span class="p">(</span><span class="s2">&quot;quippy.DynamicalSystem&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DynamicalSystem</span><span class="p">(</span><span class="n">f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">FortranDerivedType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Type(name=dynamicalsystem)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 195-228</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="DynamicalSystem.ds_save_state"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_save_state">[docs]</a>    <span class="k">def</span> <span class="nf">ds_save_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_save_state(self, from_[, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 564-596</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        to : Dynamicalsystem</span>
<span class="sd">        from_ : Dynamicalsystem</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Save the state of a DynamicalSystem. The output object</span>
<span class="sd">        cannot be used as an initialised DynamicalSystem since</span>
<span class="sd">        connectivity and group information is not copied to save</span>
<span class="sd">        memory. Only scalar members and the &#39;ds%atoms&#39; object</span>
<span class="sd">        (minus &#39;ds%atoms%connect&#39;) are copied. The current</span>
<span class="sd">        state of the random number generator is also saved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_save_state</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="n">from_</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_restore_state"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_restore_state">[docs]</a>    <span class="k">def</span> <span class="nf">ds_restore_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_restore_state(self, from_)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 604-625</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        to : Dynamicalsystem</span>
<span class="sd">        from_ : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        Restore a DynamicalSystem to a previously saved state.</span>
<span class="sd">        Only scalar members and &#39;ds%atoms&#39; (minus &#39;ds%atoms%connect&#39;)</span>
<span class="sd">        are copied back; &#39;to&#39; should be a properly initialised</span>
<span class="sd">        DynamicalSystem object. The saved state of the random</span>
<span class="sd">        number generator is also restored. &#39;calc_dists()&#39; is</span>
<span class="sd">        called on the restored atoms object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_restore_state</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">from_</span><span class="o">=</span><span class="n">from_</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.n_thermostat"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.n_thermostat">[docs]</a>    <span class="k">def</span> <span class="nf">n_thermostat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        n_thermostat = n_thermostat(self)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 832-835</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n_thermostat : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_thermostat</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_n_thermostat</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n_thermostat</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.is_damping_enabled"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.is_damping_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">is_damping_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        is_damping_enabled = is_damping_enabled(self)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 970-977</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        is_damping_enabled : bool</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_damping_enabled</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_is_damping_enabled</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">is_damping_enabled</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.get_damping_time"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.get_damping_time">[docs]</a>    <span class="k">def</span> <span class="nf">get_damping_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_damping_time = get_damping_time(self)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 979-984</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        get_damping_time : float</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">get_damping_time</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_get_damping_time</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">get_damping_time</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.enable_damping"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.enable_damping">[docs]</a>    <span class="k">def</span> <span class="nf">enable_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">damp_time</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        enable_damping(self, damp_time)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 988-992</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        damp_time : float</span>
<span class="sd">        </span>
<span class="sd">        Enable damping, with damping time set to `damp_time`. Only atoms</span>
<span class="sd">        flagged in the `damp_mask` property will be affected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_enable_damping</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">damp_time</span><span class="o">=</span><span class="n">damp_time</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.disable_damping"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.disable_damping">[docs]</a>    <span class="k">def</span> <span class="nf">disable_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_damping(self)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 994-996</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_disable_damping</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.thermostat_temperatures"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.thermostat_temperatures">[docs]</a>    <span class="k">def</span> <span class="nf">thermostat_temperatures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        thermostat_temperatures(self, temps)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1246-1258</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        temps : float array</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_thermostat_temperatures</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">temps</span><span class="o">=</span><span class="n">temps</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.temperature"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.temperature">[docs]</a>    <span class="k">def</span> <span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_all</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">instantaneous</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        temperature = temperature(self[, property, value, include_all, instantaneous, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1270-1324</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        property : str</span>
<span class="sd">        value : int</span>
<span class="sd">        include_all : bool</span>
<span class="sd">        instantaneous : bool</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        temperature : float</span>
<span class="sd">        </span>
<span class="sd">        Return the temperature, assuming each degree of freedom contributes</span>
<span class="sd">        $\frac{1}{2}kT$. By default only moving and thermostatted atoms are</span>
<span class="sd">        included --- this can be overriden by setting &#39;include_all&#39; to true.</span>
<span class="sd">        &#39;region&#39; can be used to restrict</span>
<span class="sd">        the calculation to a particular thermostat</span>
<span class="sd">        region. &#39;instantaneous&#39; controls whether the calculation should</span>
<span class="sd">        be carried out using the current values of the velocities and</span>
<span class="sd">        masses, or whether to return the value at the last Verlet step</span>
<span class="sd">        (the latter is the default).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_temperature</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="nb">property</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> \
            <span class="n">include_all</span><span class="o">=</span><span class="n">include_all</span><span class="p">,</span> <span class="n">instantaneous</span><span class="o">=</span><span class="n">instantaneous</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">temperature</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.rescale_velo"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.rescale_velo">[docs]</a>    <span class="k">def</span> <span class="nf">rescale_velo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">mass_weighted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zero_l</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rescale_velo(self, temp[, mass_weighted, zero_l])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1342-1370</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        temp : float</span>
<span class="sd">        mass_weighted : bool</span>
<span class="sd">        zero_l : bool</span>
<span class="sd">        </span>
<span class="sd">        Rescale the atomic velocities to temperature &#39;temp&#39;. If the</span>
<span class="sd">        current temperature is zero, we first randomise the velocites.</span>
<span class="sd">        If &#39;mass_weighted&#39; is true, then the velocites are weighted by</span>
<span class="sd">        $1/sqrt{m}$. Linear momentum is zeroed automatically.  If</span>
<span class="sd">        &#39;zero_l&#39; is true then the angular momentum is also zeroed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_rescale_velo</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span> <span class="n">mass_weighted</span><span class="o">=</span><span class="n">mass_weighted</span><span class="p">,</span> <span class="n">zero_l</span><span class="o">=</span><span class="n">zero_l</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.zero_momentum"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.zero_momentum">[docs]</a>    <span class="k">def</span> <span class="nf">zero_momentum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        zero_momentum(self[, indices])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1422-1434</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        indices : int array</span>
<span class="sd">        </span>
<span class="sd">        Change velocities to those that the system would have in the zero momentum frame.</span>
<span class="sd">        Optionalally zero the total momentum of a subset of atoms, specified by &#39;indices&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_zero_momentum</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.advance_verlet1"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.advance_verlet1">[docs]</a>    <span class="k">def</span> <span class="nf">advance_verlet1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">virial</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_constraint_force</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_calc_dists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        advance_verlet1(self, dt[, virial, parallel, store_constraint_force, do_calc_dists, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1547-1714</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        dt : float</span>
<span class="sd">        virial : float array</span>
<span class="sd">        parallel : bool</span>
<span class="sd">        store_constraint_force : bool</span>
<span class="sd">        do_calc_dists : bool</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Advance the velocities by half the time-step &#39;dt&#39; and the</span>
<span class="sd">        positions by a full time-step. A typical MD loop should</span>
<span class="sd">        resemble the following code(Python example, Fortran is similar):</span>
<span class="sd">        </span>
<span class="sd">        &gt; ds.atoms.calc_connect()</span>
<span class="sd">        &gt; for n in range(n_steps):</span>
<span class="sd">        &gt;    ds.advance_verlet1(dt)</span>
<span class="sd">        &gt;    pot.calc(ds.atoms, force=True, energy=True)</span>
<span class="sd">        &gt;    ds.advance_verlet2(dt, ds.atoms.force)</span>
<span class="sd">        &gt;    ds.print_status(epot=ds.atoms.energy)</span>
<span class="sd">        &gt;    if n % connect_interval == 0:</span>
<span class="sd">        &gt;       ds.atoms.calc_connect()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_advance_verlet1</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">virial</span><span class="o">=</span><span class="n">virial</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="n">parallel</span><span class="p">,</span> \
            <span class="n">store_constraint_force</span><span class="o">=</span><span class="n">store_constraint_force</span><span class="p">,</span> <span class="n">do_calc_dists</span><span class="o">=</span><span class="n">do_calc_dists</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.advance_verlet2"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.advance_verlet2">[docs]</a>    <span class="k">def</span> <span class="nf">advance_verlet2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">virial</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_constraint_force</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        advance_verlet2(self, dt, f[, virial, e, parallel, store_constraint_force, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1740-1857</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        dt : float</span>
<span class="sd">        f : float array</span>
<span class="sd">        virial : float array</span>
<span class="sd">        e : float</span>
<span class="sd">        parallel : bool</span>
<span class="sd">        store_constraint_force : bool</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Advances the velocities by the second half time-step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_advance_verlet2</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">virial</span><span class="o">=</span><span class="n">virial</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="n">parallel</span><span class="p">,</span> \
            <span class="n">store_constraint_force</span><span class="o">=</span><span class="n">store_constraint_force</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.advance_verlet"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.advance_verlet">[docs]</a>    <span class="k">def</span> <span class="nf">advance_verlet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">virial</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_constraint_force</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">do_calc_dists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        advance_verlet(self, dt, f[, virial, e, parallel, store_constraint_force, do_calc_dists, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1867-1887</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds : Dynamicalsystem</span>
<span class="sd">        dt : float</span>
<span class="sd">        f : float array</span>
<span class="sd">        virial : float array</span>
<span class="sd">        e : float</span>
<span class="sd">        parallel : bool</span>
<span class="sd">        store_constraint_force : bool</span>
<span class="sd">        do_calc_dists : bool</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Calls&#39; advance_verlet2&#39; followed by &#39;advance_verlet1&#39;. Outside this routine the</span>
<span class="sd">        velocities will be half-stepped. This allows a simpler MD loop:</span>
<span class="sd">        &gt;  for n in range(n_steps):</span>
<span class="sd">        &gt;      pot.calc(ds.atoms, force=True, energy=True)</span>
<span class="sd">        &gt;      ds.advance_verlet(dt, ds.atoms.force)</span>
<span class="sd">        &gt;      ds.print_status(epot=ds.atoms.energy)</span>
<span class="sd">        &gt;      if n % connect_interval == 0:</span>
<span class="sd">        &gt;         ds.atoms.calc_connect()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_advance_verlet</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">virial</span><span class="o">=</span><span class="n">virial</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="n">parallel</span><span class="p">,</span> \
            <span class="n">store_constraint_force</span><span class="o">=</span><span class="n">store_constraint_force</span><span class="p">,</span> <span class="n">do_calc_dists</span><span class="o">=</span><span class="n">do_calc_dists</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_print_status"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_print_status">[docs]</a>    <span class="k">def</span> <span class="nf">ds_print_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">instantaneous</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_print_status(self[, label, epot, instantaneous, file, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1899-1963</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        label : str</span>
<span class="sd">        epot : float</span>
<span class="sd">        instantaneous : bool</span>
<span class="sd">        file : Inoutput</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Print a status line showing the current time, temperature, the mean temperature</span>
<span class="sd">        the total energy and the total momentum for this DynamicalSystem. If present, the optional</span>
<span class="sd">        &#39;label&#39; parameter should be a one character label for the log lines and is printed</span>
<span class="sd">        in the first column of the output. &#39;epot&#39; should be the potential energy</span>
<span class="sd">        if this is available. &#39;instantaneous&#39; has the same meaning as in &#39;temperature&#39; routine.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_print_status</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">epot</span><span class="o">=</span><span class="n">epot</span><span class="p">,</span> <span class="n">instantaneous</span><span class="o">=</span><span class="n">instantaneous</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span> \
            <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">file</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_bondanglecos"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_bondanglecos">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_bondanglecos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_bondanglecos(self, i, j, k[, c, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2005-2038</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        j : int</span>
<span class="sd">        k : int</span>
<span class="sd">        c : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain the bond angle cosine between atoms i, j, and k</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_bondanglecos</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> \
            <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_bondlength"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_bondlength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">di</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_bondlength(self, i, j, d[, di, t0, tau, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2041-2082</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        j : int</span>
<span class="sd">        d : float</span>
<span class="sd">        di : float</span>
<span class="sd">        t0 : float</span>
<span class="sd">        tau : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain the bond between atoms i and j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_bondlength</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">di</span><span class="o">=</span><span class="n">di</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> \
            <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_bondlength_sq"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_sq">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_bondlength_sq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_bondlength_sq(self, i, j[, d, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2085-2111</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        j : int</span>
<span class="sd">        d : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain the bond between atoms i and j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_bondlength_sq</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> \
            <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_bondlength_dev_pow"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_dev_pow">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_bondlength_dev_pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">di</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_bondlength_dev_pow(self, i, j, p, d[, di, t0, tau, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2114-2155</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        j : int</span>
<span class="sd">        p : float</span>
<span class="sd">        d : float</span>
<span class="sd">        di : float</span>
<span class="sd">        t0 : float</span>
<span class="sd">        tau : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain the bond between atoms i and j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_bondlength_dev_pow</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">di</span><span class="o">=</span><span class="n">di</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> \
            <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_bondlength_diff"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_diff">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_bondlength_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">di</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_bondlength_diff(self, i, j, k, d[, di, t0, tau, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2161-2195</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        j : int</span>
<span class="sd">        k : int</span>
<span class="sd">        d : float</span>
<span class="sd">        di : float</span>
<span class="sd">        t0 : float</span>
<span class="sd">        tau : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain the difference of bond length between atoms i--j and j--k</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_bondlength_diff</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">di</span><span class="o">=</span><span class="n">di</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> \
            <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_gap_energy"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_gap_energy">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_gap_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_gap_energy(self, d[, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2201-2222</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        d : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain the energy gap of two resonance structures</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_gap_energy</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> \
            <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_atom_plane"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_atom_plane">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_atom_plane</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">plane_n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_atom_plane(self, i, plane_n[, d, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2225-2248</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        plane_n : float array</span>
<span class="sd">        d : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain an atom to lie in a particluar plane</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_atom_plane</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">plane_n</span><span class="o">=</span><span class="n">plane_n</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> \
            <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_struct_factor_like_mag"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_mag">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_struct_factor_like_mag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_struct_factor_like_mag(self, z, q, sf[, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2251-2296</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        z : int</span>
<span class="sd">        q : float array</span>
<span class="sd">        sf : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain an atom to lie in a particluar plane</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_struct_factor_like_mag</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="n">sf</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> \
            <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_struct_factor_like_r"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_r">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_struct_factor_like_r</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_struct_factor_like_r(self, z, q, sf[, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2299-2344</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        z : int</span>
<span class="sd">        q : float array</span>
<span class="sd">        sf : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain an atom to lie in a particluar plane</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_struct_factor_like_r</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="n">sf</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> \
            <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.constrain_struct_factor_like_i"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_i">[docs]</a>    <span class="k">def</span> <span class="nf">constrain_struct_factor_like_i</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constrain_struct_factor_like_i(self, z, q, sf[, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2347-2392</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        z : int</span>
<span class="sd">        q : float array</span>
<span class="sd">        sf : float</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Constrain an atom to lie in a particluar plane</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_constrain_struct_factor_like_i</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="n">sf</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> \
            <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_add_constraint"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_add_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">ds_add_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">update_ndof</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraint_k</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">print_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_add_constraint(self, atoms, func, data[, update_ndof, restraint_k, bound, tol, print_summary])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2396-2468</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        atoms : int array</span>
<span class="sd">        func : int</span>
<span class="sd">        data : float array</span>
<span class="sd">        update_ndof : bool</span>
<span class="sd">        restraint_k : float</span>
<span class="sd">        bound : int</span>
<span class="sd">        tol : float</span>
<span class="sd">        print_summary : bool</span>
<span class="sd">        </span>
<span class="sd">        Add a constraint to the DynamicalSystem and reduce the number of degrees of freedom,</span>
<span class="sd">        unless &#39;update_Ndof&#39; is present and false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_add_constraint</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">update_ndof</span><span class="o">=</span><span class="n">update_ndof</span><span class="p">,</span> \
            <span class="n">restraint_k</span><span class="o">=</span><span class="n">restraint_k</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="n">print_summary</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_amend_constraint"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_amend_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">ds_amend_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_amend_constraint(self, constraint, func, data[, k])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 2474-2479</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        constraint : int</span>
<span class="sd">        func : int</span>
<span class="sd">        data : float array</span>
<span class="sd">        k : float</span>
<span class="sd">        </span>
<span class="sd">        Replace a constraint involving some atoms with a different constraint involving</span>
<span class="sd">        the same atoms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_amend_constraint</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_print"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_print">[docs]</a>    <span class="k">def</span> <span class="nf">ds_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_print(self[, file])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1970-1994</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        file : Inoutput</span>
<span class="sd">        </span>
<span class="sd">        Print lots of information about this DynamicalSystem in text format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_print</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">file</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span></div>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms_in</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">acceleration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restraints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rigidbodies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        self = Dynamicalsystem(atoms_in[, velocity, acceleration, constraints, restraints, rigidbodies, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 308-454</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atoms_in : Atoms</span>
<span class="sd">        velocity : float array</span>
<span class="sd">        acceleration : float array</span>
<span class="sd">        constraints : int</span>
<span class="sd">        restraints : int</span>
<span class="sd">        rigidbodies : int</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        Initialise this DynamicalSystem from an Atoms object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">FortranDerivedType</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_initialise</span><span class="p">(</span><span class="n">atoms_in</span><span class="o">=</span><span class="n">atoms_in</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="n">velocity</span><span class="p">,</span> <span class="n">acceleration</span><span class="o">=</span><span class="n">acceleration</span><span class="p">,</span> \
            <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">,</span> <span class="n">restraints</span><span class="o">=</span><span class="n">restraints</span><span class="p">,</span> <span class="n">rigidbodies</span><span class="o">=</span><span class="n">rigidbodies</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">result</span>
    
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Destructor for class Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 456-488</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Free up the memory used by this DynamicalSystem</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alloc</span><span class="p">:</span>
            <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_finalise</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    
<div class="viewcode-block" id="DynamicalSystem.ds_kinetic_energy"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_kinetic_energy">[docs]</a>    <span class="k">def</span> <span class="nf">ds_kinetic_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_ke</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ke = ds_kinetic_energy(self[, local_ke, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1135-1143</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        local_ke : bool</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ke : float</span>
<span class="sd">        </span>
<span class="sd">        Return the total kinetic energy $E_k = \sum_{i} \frac{1}{2} m v^2$</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ke</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_kinetic_energy</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">local_ke</span><span class="o">=</span><span class="n">local_ke</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ke</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_kinetic_virial"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_kinetic_virial">[docs]</a>    <span class="k">def</span> <span class="nf">ds_kinetic_virial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        kv = ds_kinetic_virial(self[, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1194-1201</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        kv : float array</span>
<span class="sd">        </span>
<span class="sd">        Return the total kinetic virial $w_ij = \sum_{k} \frac{1}{2} m v_i v_j$</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kv</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_kinetic_virial</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kv</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_angular_momentum"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_angular_momentum">[docs]</a>    <span class="k">def</span> <span class="nf">ds_angular_momentum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        l = ds_angular_momentum(self[, origin, indices])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1041-1046</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        origin : float array</span>
<span class="sd">        indices : int array</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        l : float array</span>
<span class="sd">        </span>
<span class="sd">        Return the angular momentum of all the atoms in this DynamicalSystem, defined by</span>
<span class="sd">        $\mathbf{L} = \sum_{i} \mathbf{r_i} \times \mathbf{v_i}$.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_angular_momentum</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">l</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_momentum"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_momentum">[docs]</a>    <span class="k">def</span> <span class="nf">ds_momentum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        p = ds_momentum(self[, indices])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1005-1009</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        indices : int array</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        p : float array</span>
<span class="sd">        </span>
<span class="sd">        Return the total momentum $\mathbf{p} = \sum_i \mathbf{m_i} \mathbf{v_i}$.</span>
<span class="sd">        Optionally only include the contribution of a subset of atoms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_momentum</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_add_thermostat"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_add_thermostat">[docs]</a>    <span class="k">def</span> <span class="nf">ds_add_thermostat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_bn</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tau_cell</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bulk_modulus_estimate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">cell_oscillation_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nhl_tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nhl_mu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">massive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region_i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_add_thermostat(self, type_bn, t[, gamma, q, tau, tau_cell, p, bulk_modulus_estimate, cell_oscillation_time, nhl_tau, \</span>
<span class="sd">            nhl_mu, massive, region_i])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 842-889</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        type_bn : int</span>
<span class="sd">        t : float</span>
<span class="sd">        gamma : float</span>
<span class="sd">        q : float</span>
<span class="sd">        tau : float</span>
<span class="sd">        tau_cell : float</span>
<span class="sd">        p : float</span>
<span class="sd">        bulk_modulus_estimate : float</span>
<span class="sd">        cell_oscillation_time : float</span>
<span class="sd">        nhl_tau : float</span>
<span class="sd">        nhl_mu : float</span>
<span class="sd">        massive : bool</span>
<span class="sd">        region_i : int</span>
<span class="sd">        </span>
<span class="sd">        Add a new thermostat to this DynamicalSystem. &#39;type&#39; should</span>
<span class="sd">        be one of the following thermostat types:</span>
<span class="sd">        </span>
<span class="sd">        * &#39;THERMOSTAT_NONE&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_LANGEVIN&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_NOSE_HOOVER&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_NOSE_HOOVER_LANGEVIN&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_LANGEVIN_NPT&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_LANGEVIN_PR&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_NPH_ANDERSEN&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_NPH_PR&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_LANGEVIN_OU&#39;</span>
<span class="sd">        * &#39;THERMOSTAT_LANGEVIN_NPT_NB&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;T&#39; is the target temperature. &#39;Q&#39; is the Nose-Hoover coupling constant. Only one</span>
<span class="sd">        of &#39;tau&#39; or &#39;gamma&#39; should be given. &#39;p&#39; is the external</span>
<span class="sd">        pressure for the case of Langevin NPT.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_add_thermostat</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">type_bn</span><span class="o">=</span><span class="n">type_bn</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> \
            <span class="n">tau_cell</span><span class="o">=</span><span class="n">tau_cell</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">bulk_modulus_estimate</span><span class="o">=</span><span class="n">bulk_modulus_estimate</span><span class="p">,</span> <span class="n">cell_oscillation_time</span><span class="o">=</span><span class="n">cell_oscillation_time</span><span class="p">,</span> \
            <span class="n">nhl_tau</span><span class="o">=</span><span class="n">nhl_tau</span><span class="p">,</span> <span class="n">nhl_mu</span><span class="o">=</span><span class="n">nhl_mu</span><span class="p">,</span> <span class="n">massive</span><span class="o">=</span><span class="n">massive</span><span class="p">,</span> <span class="n">region_i</span><span class="o">=</span><span class="n">region_i</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_remove_thermostat"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_remove_thermostat">[docs]</a>    <span class="k">def</span> <span class="nf">ds_remove_thermostat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_bn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_remove_thermostat(self, index_bn)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 837-840</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        index_bn : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_remove_thermostat</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">index_bn</span><span class="o">=</span><span class="n">index_bn</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_print_thermostats"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_print_thermostats">[docs]</a>    <span class="k">def</span> <span class="nf">ds_print_thermostats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_print_thermostats(self)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 1965-1967</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_print_thermostats</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_set_barostat"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_set_barostat">[docs]</a>    <span class="k">def</span> <span class="nf">ds_set_barostat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_bn</span><span class="p">,</span> <span class="n">p_ext</span><span class="p">,</span> <span class="n">hydrostatic_strain</span><span class="p">,</span> <span class="n">diagonal_strain</span><span class="p">,</span> <span class="n">finite_strain_formulation</span><span class="p">,</span> <span class="n">tau_epsilon</span><span class="p">,</span> \
        <span class="n">w_epsilon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_epsilon_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thermalise</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_set_barostat(self, type_bn, p_ext, hydrostatic_strain, diagonal_strain, finite_strain_formulation, tau_epsilon[, \</span>
<span class="sd">            w_epsilon, t, w_epsilon_factor, thermalise])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 814-830</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        type_bn : int</span>
<span class="sd">        p_ext : float</span>
<span class="sd">        hydrostatic_strain : bool</span>
<span class="sd">        diagonal_strain : bool</span>
<span class="sd">        finite_strain_formulation : bool</span>
<span class="sd">        tau_epsilon : float</span>
<span class="sd">        w_epsilon : float</span>
<span class="sd">        t : float</span>
<span class="sd">        w_epsilon_factor : float</span>
<span class="sd">        thermalise : bool</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_set_barostat</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">type_bn</span><span class="o">=</span><span class="n">type_bn</span><span class="p">,</span> <span class="n">p_ext</span><span class="o">=</span><span class="n">p_ext</span><span class="p">,</span> \
            <span class="n">hydrostatic_strain</span><span class="o">=</span><span class="n">hydrostatic_strain</span><span class="p">,</span> <span class="n">diagonal_strain</span><span class="o">=</span><span class="n">diagonal_strain</span><span class="p">,</span> \
            <span class="n">finite_strain_formulation</span><span class="o">=</span><span class="n">finite_strain_formulation</span><span class="p">,</span> <span class="n">tau_epsilon</span><span class="o">=</span><span class="n">tau_epsilon</span><span class="p">,</span> <span class="n">w_epsilon</span><span class="o">=</span><span class="n">w_epsilon</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> \
            <span class="n">w_epsilon_factor</span><span class="o">=</span><span class="n">w_epsilon_factor</span><span class="p">,</span> <span class="n">thermalise</span><span class="o">=</span><span class="n">thermalise</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_add_thermostats"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_add_thermostats">[docs]</a>    <span class="k">def</span> <span class="nf">ds_add_thermostats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_bn</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_a</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma_a</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q_a</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> \
        <span class="n">tau_a</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region_i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_add_thermostats(self, type_bn, n[, t, t_a, gamma, gamma_a, q, q_a, tau, tau_a, region_i])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 896-942</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        type_bn : int</span>
<span class="sd">        n : int</span>
<span class="sd">        t : float</span>
<span class="sd">        t_a : float array</span>
<span class="sd">        gamma : float</span>
<span class="sd">        gamma_a : float array</span>
<span class="sd">        q : float</span>
<span class="sd">        q_a : float array</span>
<span class="sd">        tau : float</span>
<span class="sd">        tau_a : float array</span>
<span class="sd">        region_i : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_add_thermostats</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">type_bn</span><span class="o">=</span><span class="n">type_bn</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">t_a</span><span class="o">=</span><span class="n">t_a</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> \
            <span class="n">gamma_a</span><span class="o">=</span><span class="n">gamma_a</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">q_a</span><span class="o">=</span><span class="n">q_a</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_a</span><span class="o">=</span><span class="n">tau_a</span><span class="p">,</span> <span class="n">region_i</span><span class="o">=</span><span class="n">region_i</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DynamicalSystem.ds_update_thermostat"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.ds_update_thermostat">[docs]</a>    <span class="k">def</span> <span class="nf">ds_update_thermostat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ds_update_thermostat(self[, t, p, i])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 949-957</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        t : float</span>
<span class="sd">        p : float</span>
<span class="sd">        i : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_update_thermostat</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">)</span></div>
    
    <span class="k">def</span> <span class="nf">_ds_add_atom_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        _ds_add_atom_single(self, z[, mass, p, v, a, t, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 632-652</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        z : int</span>
<span class="sd">        mass : float</span>
<span class="sd">        p : float array</span>
<span class="sd">        v : float array</span>
<span class="sd">        a : float array</span>
<span class="sd">        t : int array</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_add_atom_single</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_ds_add_atom_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        _ds_add_atom_multiple(self, z[, mass, p, v, a, t, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 657-709</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        z : int array</span>
<span class="sd">        mass : float array</span>
<span class="sd">        p : float array</span>
<span class="sd">        v : float array</span>
<span class="sd">        a : float array</span>
<span class="sd">        t : int array</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_add_atom_multiple</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    
<div class="viewcode-block" id="DynamicalSystem.add_atoms"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.add_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">add_atoms</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_atoms(*args, **kwargs)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 235-236</span>
<span class="sd">        </span>
<span class="sd">        Overloaded interface containing the following procedures:</span>
<span class="sd">          _ds_add_atom_single</span>
<span class="sd">          _ds_add_atom_multiple</span>
<span class="sd">        </span>
<span class="sd">        Add one or more atoms to this DynamicalSystem. Equivalent to &#39;Atoms%add_atoms&#39;,</span>
<span class="sd">        but also appends the number of degrees of freedom correctly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DynamicalSystem</span><span class="o">.</span><span class="n">_ds_add_atom_single</span><span class="p">,</span> <span class="n">DynamicalSystem</span><span class="o">.</span><span class="n">_ds_add_atom_multiple</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">continue</span></div>
    
    <span class="k">def</span> <span class="nf">_ds_remove_atom_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        _ds_remove_atom_single(self, i[, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 711-717</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        i : int</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_remove_atom_single</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_ds_remove_atom_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomlist_in</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        _ds_remove_atom_multiple(self, atomlist_in[, error])</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 719-776</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        this : Dynamicalsystem</span>
<span class="sd">        atomlist_in : int array</span>
<span class="sd">        error : int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_ds_remove_atom_multiple</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">atomlist_in</span><span class="o">=</span><span class="n">atomlist_in</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    
<div class="viewcode-block" id="DynamicalSystem.remove_atoms"><a class="viewcode-back" href="../../dynamicalsystem.html#quippy.dynamicalsystem.DynamicalSystem.remove_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">remove_atoms</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        remove_atoms(*args, **kwargs)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp lines 240-241</span>
<span class="sd">        </span>
<span class="sd">        Overloaded interface containing the following procedures:</span>
<span class="sd">          _ds_remove_atom_single</span>
<span class="sd">          _ds_remove_atom_multiple</span>
<span class="sd">        </span>
<span class="sd">        Remove one or more atoms from this DynamicalSystem. Equivalent of &#39;Atoms%remove_atoms&#39;,</span>
<span class="sd">        but also amends the number of degrees of freedom correctly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DynamicalSystem</span><span class="o">.</span><span class="n">_ds_remove_atom_single</span><span class="p">,</span> <span class="n">DynamicalSystem</span><span class="o">.</span><span class="n">_ds_remove_atom_multiple</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">continue</span></div>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element n ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 197</span>
<span class="sd">        </span>
<span class="sd">        Number of atoms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__n</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@n</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__n</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nsteps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element nsteps ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 198</span>
<span class="sd">        </span>
<span class="sd">        Number of integration steps</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__nsteps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@nsteps</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nsteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__nsteps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrigid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element nrigid ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 199</span>
<span class="sd">        </span>
<span class="sd">        Number of rigid bodies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__nrigid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@nrigid</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nrigid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrigid</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__nrigid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">nrigid</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nconstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element nconstraints ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 200</span>
<span class="sd">        </span>
<span class="sd">        Number of constraints</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__nconstraints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@nconstraints</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nconstraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nconstraints</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__nconstraints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">nconstraints</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nrestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element nrestraints ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 201</span>
<span class="sd">        </span>
<span class="sd">        Number of restraints</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__nrestraints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@nrestraints</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nrestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrestraints</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__nrestraints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">nrestraints</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ndof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element ndof ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 202</span>
<span class="sd">        </span>
<span class="sd">        Number of degrees of freedom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__ndof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@ndof</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ndof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ndof</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__ndof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">ndof</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element t ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 203</span>
<span class="sd">        </span>
<span class="sd">        Time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__t</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@t</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__t</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element dt ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 204</span>
<span class="sd">        </span>
<span class="sd">        Last time step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__dt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@dt</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__dt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">avg_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element avg_temp ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 205</span>
<span class="sd">        </span>
<span class="sd">        Time-averaged temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__avg_temp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@avg_temp</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">avg_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">avg_temp</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__avg_temp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">avg_temp</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cur_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element cur_temp ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 206</span>
<span class="sd">        </span>
<span class="sd">        Current temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__cur_temp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@cur_temp</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cur_temp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cur_temp</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__cur_temp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">cur_temp</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">avg_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element avg_time ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 207</span>
<span class="sd">        </span>
<span class="sd">        Averaging time, in fs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__avg_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@avg_time</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">avg_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">avg_time</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__avg_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">avg_time</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element dw ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 208</span>
<span class="sd">        </span>
<span class="sd">        Increment of work done this time step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__dw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@dw</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dw</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__dw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">dw</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element work ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 209</span>
<span class="sd">        </span>
<span class="sd">        Total work done</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__work</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@work</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">work</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__work</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">work</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">epot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element epot ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 210</span>
<span class="sd">        </span>
<span class="sd">        Total potential energy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__epot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@epot</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">epot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epot</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__epot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">epot</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ekin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element ekin ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 211</span>
<span class="sd">        </span>
<span class="sd">        Current kinetic energy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__ekin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@ekin</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ekin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ekin</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__ekin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">ekin</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wkin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element wkin ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 212</span>
<span class="sd">        </span>
<span class="sd">        Current kinetic contribution to the virial</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_ndim</span><span class="p">,</span> <span class="n">array_type</span><span class="p">,</span> <span class="n">array_shape</span><span class="p">,</span> <span class="n">array_handle</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__array__wkin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array_handle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span><span class="p">:</span>
            <span class="n">wkin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span><span class="p">[</span><span class="n">array_handle</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wkin</span> <span class="o">=</span> <span class="n">f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">sizeof_fortran_t</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span>
                                    <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__array__wkin</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span><span class="p">[</span><span class="n">array_handle</span><span class="p">]</span> <span class="o">=</span> <span class="n">wkin</span>
        <span class="k">return</span> <span class="n">wkin</span>
    
    <span class="nd">@wkin</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">wkin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wkin</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wkin</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">wkin</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ext_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element ext_energy ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 213</span>
<span class="sd">        </span>
<span class="sd">        Extended energy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__ext_energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@ext_energy</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ext_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ext_energy</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__ext_energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">ext_energy</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thermostat_dw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element thermostat_dw ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 214</span>
<span class="sd">        </span>
<span class="sd">        Increment of work done by thermostat</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__thermostat_dw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@thermostat_dw</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thermostat_dw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thermostat_dw</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__thermostat_dw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">thermostat_dw</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thermostat_work</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element thermostat_work ftype=real(dp) pytype=float</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 215</span>
<span class="sd">        </span>
<span class="sd">        Total work done by thermostat</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__thermostat_work</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@thermostat_work</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thermostat_work</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thermostat_work</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__thermostat_work</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">thermostat_work</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initialised</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element initialised ftype=logical pytype=bool</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 216</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__initialised</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@initialised</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">initialised</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialised</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__initialised</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">initialised</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">random_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element random_seed ftype=integer                                pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 217</span>
<span class="sd">        </span>
<span class="sd">        RNG seed, used by &#39;ds_save_state&#39; and &#39;ds_restore_state&#39; only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__random_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@random_seed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">random_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">random_seed</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__random_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">random_seed</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">group_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element group_lookup ftype=integer pytype=int</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 219</span>
<span class="sd">        </span>
<span class="sd">        Stores which group atom $i$ is in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_ndim</span><span class="p">,</span> <span class="n">array_type</span><span class="p">,</span> <span class="n">array_shape</span><span class="p">,</span> <span class="n">array_handle</span> <span class="o">=</span> \
            <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__array__group_lookup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array_handle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span><span class="p">:</span>
            <span class="n">group_lookup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span><span class="p">[</span><span class="n">array_handle</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">group_lookup</span> <span class="o">=</span> <span class="n">f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">f90wrap</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">sizeof_fortran_t</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span>
                                    <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__array__group_lookup</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span><span class="p">[</span><span class="n">array_handle</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_lookup</span>
        <span class="k">return</span> <span class="n">group_lookup</span>
    
    <span class="nd">@group_lookup</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">group_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_lookup</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_lookup</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_lookup</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element atoms ftype=type(atoms) pytype=Atoms</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 221</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atoms_handle</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__atoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">atoms_handle</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">:</span>
            <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">atoms_handle</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atoms</span> <span class="o">=</span> <span class="n">Atoms</span><span class="o">.</span><span class="n">from_handle</span><span class="p">(</span><span class="n">atoms_handle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_objs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">atoms_handle</span><span class="p">)]</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="k">return</span> <span class="n">atoms</span>
    
    <span class="nd">@atoms</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">_handle</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__atoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">atoms</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">print_thermostat_temps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element print_thermostat_temps ftype=logical pytype=bool</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Defined at DynamicalSystem.fpp line 228</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__get__print_thermostat_temps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>
    
    <span class="nd">@print_thermostat_temps</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">print_thermostat_temps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_thermostat_temps</span><span class="p">):</span>
        <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem__set__print_thermostat_temps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">print_thermostat_temps</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;dynamicalsystem&gt;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;    n : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    nsteps : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsteps</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    nrigid : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrigid</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    nconstraints : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nconstraints</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    nrestraints : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrestraints</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    ndof : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndof</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    t : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    dt : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    avg_temp : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_temp</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    cur_temp : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cur_temp</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    avg_time : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_time</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    dw : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dw</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    work : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    epot : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epot</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    ekin : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ekin</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    wkin : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wkin</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    ext_energy : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_energy</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    thermostat_dw : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermostat_dw</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    thermostat_work : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermostat_work</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    initialised : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    random_seed : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    group_lookup : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_lookup</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    atoms : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">    print_thermostat_temps : &#39;</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_thermostat_temps</span><span class="p">))</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
    
    <span class="n">_dt_array_initialisers</span> <span class="o">=</span> <span class="p">[]</span>
    

<span class="k">def</span> <span class="nf">moment_of_inertia_tensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    moi = moment_of_inertia_tensor(self[, origin])</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1111-1132</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    this : Atoms</span>
<span class="sd">    origin : float array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    moi : float array</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">moi</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_moment_of_inertia_tensor</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">moi</span>

<span class="k">def</span> <span class="nf">torque</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    tau = torque(pos, force[, origin])</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1231-1244</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pos : float array</span>
<span class="sd">    force : float array</span>
<span class="sd">    origin : float array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tau : float array</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_torque</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tau</span>

<span class="k">def</span> <span class="nf">gaussian_velocity_component</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    v = gaussian_velocity_component(m, t)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1406-1409</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : float</span>
<span class="sd">    t : float</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v : float</span>
<span class="sd">    </span>
<span class="sd">    Draw a velocity component from the correct Gaussian distribution for</span>
<span class="sd">    a degree of freedom with(effective) mass &#39;m&#39; at temperature &#39;T&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_gaussian_velocity_component</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>

<span class="k">def</span> <span class="nf">zero_angular_momentum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    zero_angular_momentum(self)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1437-1458</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    this : Atoms</span>
<span class="sd">    </span>
<span class="sd">    give the system a rigid body rotation so as to zero the angular momentum about the centre of mass</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_zero_angular_momentum</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">distance_relative_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    dist, rel_velo = distance_relative_velocity(self, i, j)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 2486-2494</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    at : Atoms</span>
<span class="sd">    i : int</span>
<span class="sd">    j : int</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dist : float</span>
<span class="sd">    rel_velo : float</span>
<span class="sd">    </span>
<span class="sd">    Return the distance between two atoms and the relative velocity</span>
<span class="sd">    between them projected along the bond direction.</span>
<span class="sd">    This is useful for time dependent constraints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dist</span><span class="p">,</span> <span class="n">rel_velo</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_distance_relative_velocity</span><span class="p">(</span><span class="n">at</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span><span class="p">,</span> <span class="n">rel_velo</span>

<span class="k">def</span> <span class="nf">arrays_angular_momentum</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">velo</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    l = arrays_angular_momentum(mass, pos, velo[, origin, indices])</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1059-1083</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mass : float array</span>
<span class="sd">    pos : float array</span>
<span class="sd">    velo : float array</span>
<span class="sd">    origin : float array</span>
<span class="sd">    indices : int array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    l : float array</span>
<span class="sd">    </span>
<span class="sd">    Return the angular momentum of all the atoms in this DynamicalSystem, defined by</span>
<span class="sd">    $\mathbf{L} = \sum_{i} \mathbf{r_i} \times \mathbf{v_i}$.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_arrays_angular_momentum</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">velo</span><span class="o">=</span><span class="n">velo</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">l</span>

<span class="k">def</span> <span class="nf">arrays_momentum</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    p = arrays_momentum(mass, velo[, indices])</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1021-1037</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mass : float array</span>
<span class="sd">    velo : float array</span>
<span class="sd">    indices : int array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    p : float array</span>
<span class="sd">    </span>
<span class="sd">    Return the total momentum $\mathbf{p} = \sum_i \mathbf{m_i} \mathbf{v_i}$.</span>
<span class="sd">    Optionally only include the contribution of a subset of atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_arrays_momentum</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="o">=</span><span class="n">velo</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">_single_kinetic_energy</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ke = _single_kinetic_energy(mass, velo)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1177-1180</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mass : float</span>
<span class="sd">    velo : float array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ke : float</span>
<span class="sd">    </span>
<span class="sd">    Return the kinetic energy given a mass and a velocity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ke</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_single_kinetic_energy</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="o">=</span><span class="n">velo</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ke</span>

<span class="k">def</span> <span class="nf">_arrays_kinetic_energy</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="p">,</span> <span class="n">local_ke</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ke = _arrays_kinetic_energy(mass, velo[, local_ke])</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1183-1191</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mass : float array</span>
<span class="sd">    velo : float array</span>
<span class="sd">    local_ke : float array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ke : float</span>
<span class="sd">    </span>
<span class="sd">    Return the total kinetic energy given atomic masses and velocities</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ke</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_arrays_kinetic_energy</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="o">=</span><span class="n">velo</span><span class="p">,</span> <span class="n">local_ke</span><span class="o">=</span><span class="n">local_ke</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ke</span>

<span class="k">def</span> <span class="nf">kinetic_energy</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    kinetic_energy(*args, **kwargs)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 254-255</span>
<span class="sd">    </span>
<span class="sd">    Overloaded interface containing the following procedures:</span>
<span class="sd">      _single_kinetic_energy</span>
<span class="sd">      _arrays_kinetic_energy</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_single_kinetic_energy</span><span class="p">,</span> <span class="n">_arrays_kinetic_energy</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">continue</span>

<span class="k">def</span> <span class="nf">_single_kinetic_virial</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    kv = _single_kinetic_virial(mass, velo)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1219-1222</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mass : float</span>
<span class="sd">    velo : float array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kv : float array</span>
<span class="sd">    </span>
<span class="sd">    Return the kinetic virial given a mass and a velocity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kv</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_single_kinetic_virial</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="o">=</span><span class="n">velo</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kv</span>

<span class="k">def</span> <span class="nf">_arrays_kinetic_virial</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    kv = _arrays_kinetic_virial(mass, velo)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 1225-1229</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mass : float array</span>
<span class="sd">    velo : float array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kv : float array</span>
<span class="sd">    </span>
<span class="sd">    Return the total kinetic virial given atomic masses and velocities</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kv</span> <span class="o">=</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_arrays_kinetic_virial</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">velo</span><span class="o">=</span><span class="n">velo</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kv</span>

<span class="k">def</span> <span class="nf">kinetic_virial</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    kinetic_virial(*args, **kwargs)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp lines 257-259</span>
<span class="sd">    </span>
<span class="sd">    Overloaded interface containing the following procedures:</span>
<span class="sd">      _single_kinetic_virial</span>
<span class="sd">      _arrays_kinetic_virial</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_single_kinetic_virial</span><span class="p">,</span> <span class="n">_arrays_kinetic_virial</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">continue</span>

<span class="k">def</span> <span class="nf">get_type_atom</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element type_atom ftype=integer pytype=int</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp line 192</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem_module__get__type_atom</span><span class="p">()</span>

<span class="n">TYPE_ATOM</span> <span class="o">=</span> <span class="n">get_type_atom</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">get_type_constrained</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element type_constrained ftype=integer pytype=int</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Defined at DynamicalSystem.fpp line 193</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">quippy</span><span class="o">.</span><span class="n">_quippy</span><span class="o">.</span><span class="n">f90wrap_dynamicalsystem_module__get__type_constrained</span><span class="p">()</span>

<span class="n">TYPE_CONSTRAINED</span> <span class="o">=</span> <span class="n">get_type_constrained</span><span class="p">()</span>


<span class="n">_array_initialisers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">_dt_array_initialisers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">_array_initialisers</span><span class="p">:</span>
        <span class="n">func</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;unallocated array(s) detected on import of module &quot;dynamicalsystem_module&quot;.&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">_dt_array_initialisers</span><span class="p">:</span>
    <span class="n">func</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2008-2020, James Kermode.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>